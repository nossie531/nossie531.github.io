<?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 330 300" height="300">
	<style>
@import url("style/rungeKutta.css");
	</style>
	<script href="lib/graphViewer.js"/>
	<script href="lib/rungeKutta.js"/>
	<script><![CDATA[
document.addEventListener("DOMContentLoaded", () => {
	const largeStep = 2;
	const smallStep = 0.01;
	const range = {min: 0, max: 2};
	const origin = {x: 10, y: 10};
	const gridArea = {x:15, y:15, width: 275, height: 275};
	const viewer = new GraphViewer(range, origin, gridArea);
	const real = getAlgorithm(smallStep, range).result();
	const calc = getAlgorithm(largeStep, range).result();
	const error = [real.at(-1), calc.at(-1)];
	viewer.magnify = 120;
	viewer.appendAxis("axis");
	viewer.appendGridX("step", largeStep);
	viewer.setFuncPath("real", real);
	viewer.setFuncPath("calc", calc);
	viewer.setPathLine("grad", calc, 0.5);
	viewer.setPath("error", error);
	viewer.setLabel("errorText", getErrorTextPos(error), 15);
});

function getAlgorithm(step, range) {
	const result = new ExplicitEuler;
	result.df = (x, y) => y * 0.5;
	result.range = range;
	result.value = 0.6;
	result.step = step;
	return result;
}

function getErrorTextPos(error) {
	return {x: error[0].x, y: (error[0].y + error[1].y) / 2};
}
	]]></script>
	<defs>
		<marker id="point" markerUnits="userSpaceOnUse"
			markerWidth="10" markerHeight="10" viewBox="-5 -5 10 10">
			<circle r="3"/>
		</marker>
		<marker id="arrow" markerUnits="userSpaceOnUse" orient="auto-start-reverse"
			markerWidth="20" markerHeight="20" viewBox="-10 -10 20 20">
			<path d="M2,0 L-6,4 -6,-4 Z"/>
		</marker>
		<marker id="gradSrc" markerUnits="userSpaceOnUse"
			markerWidth="10" markerHeight="10" viewBox="-5 -5 10 10">
			<circle r="4"/>
		</marker>
		<marker id="gradDst" markerUnits="userSpaceOnUse" orient="auto-start-reverse"
			markerWidth="20" markerHeight="20" viewBox="-10 -10 20 20">
			<path d="M3,0 L-8,6 -8,-6 Z"/>
		</marker>
		<marker id="lengthMark" markerUnits="userSpaceOnUse" orient="auto"
			markerWidth="10" markerHeight="20" viewBox="-5 -10 10 20">
			<path d="M 0,0 V -10"/>
		</marker>
	</defs>
	<g>
		<!-- 座標軸。-->
		<g id="axis"/>
		<!-- ステップ。-->
		<g id="step"/>
		<!-- 誤差表示。-->
		<path id="error" class="error"/>
		<!-- 真の値。-->
		<path id="real" class="flow"/>
		<!-- 計算値。-->
		<path id="calc" class="calc endCap"/>
		<!-- 勾配の方向。-->
		<path id="grad" class="grad"/>
		<!-- 横軸ラベル。-->
		<text class="label" x="300" y="280">
			<tspan class="symbol">t</tspan>
		</text>	
		<!-- 誤差ラベル。-->
		<text id="errorText" class="label error">Error</text>
	</g>
</svg>
