<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:m="http://www.w3.org/1998/Math/MathML"
	  xml:lang="ja">
	<head>
		<title>行列指数関数とベクトルとの積</title>
		<link rel="stylesheet" href="style/base.css"/>
		<script src="lib/base.js"></script>
	</head>
	<body>
		<header>
			<h1><script>Base.insertTitle();</script></h1>
		</header>
		<p class="todo">
注: 書きかけです。
		</p> <p>
行列指数関数とベクトルとの積を高速に計算する方法について。
		</p> 
		<section>
			<h1>導入</h1>
			<section>
				<h1>問題設定</h1>
				<p>
以下の<a href="#matrixExponential">行列指数関数</a>とベクトルとの積を計算する。
				</p>
				<div class="math">
<m:math display="block">
	<m:msup>
		<m:mi>e</m:mi>
		<m:mrow><m:mi>𝐀</m:mi><m:mi>t</m:mi></m:mrow>
	</m:msup>
	<m:mi>𝒃</m:mi>
</m:math>
				</div>
			</section> <section>
				<h1>記号の定義</h1>
				<ul>
					<li>
<m:math><m:mi>𝐀</m:mi></m:math> は <m:math><m:mi>n</m:mi></m:math> 次の正方行列
					</li> <li>
<m:math><m:mi>𝒃</m:mi></m:math> は <m:math><m:mi>n</m:mi></m:math> 次の列ベクトル
					</li> <li>
<m:math><m:mi>t</m:mi></m:math> は任意の実数定数
					</li> <li>
<m:math><m:mi>nnz</m:mi><m:mo stretchy="false">(</m:mo><m:mi>𝐀</m:mi><m:mo stretchy="false">)</m:mo></m:math> は行列 <m:math><m:mi>𝐀</m:mi></m:math> の非ゼロ要素の個数
					</li>
				</ul>
			</section> <section>
				<h1>用語の定義</h1>
				<section>
					<h2 id="matrixExponential">行列指数関数</h2>
					<p>
行列指数関数は以下の Taylor 展開で定義される。
					</p>
					<div class="math">
<m:math display="block">
	<m:msup><m:mi>e</m:mi><m:mi>𝐌</m:mi></m:msup>
	<m:mo>=</m:mo>
	<m:mrow>
		<m:munderover>
			<m:mo>∑</m:mo>
			<m:mrow><m:mi>k</m:mi><m:mo>=</m:mo><m:mi>0</m:mi></m:mrow>
			<m:mi>∞</m:mi>
		</m:munderover>
		<m:mfrac>
			<m:mn>1</m:mn>
			<m:mrow><m:mi>k</m:mi><m:mo>!</m:mo></m:mrow>
		</m:mfrac>
		<m:msup>
			<m:mi>𝐌</m:mi>
			<m:mi>k</m:mi>
		</m:msup>
	</m:mrow>
</m:math>
					</div>
					<p>
これは以下の通常の指数関数の Taylor 展開から連想できる。
					</p>
					<div class="math">
<m:math display="block">
	<m:msup><m:mi>e</m:mi><m:mi>x</m:mi></m:msup>
	<m:mo>=</m:mo>
	<m:mrow>
		<m:munderover>
			<m:mo>∑</m:mo>
			<m:mrow><m:mi>k</m:mi><m:mo>=</m:mo><m:mi>0</m:mi></m:mrow>
			<m:mi>∞</m:mi>
		</m:munderover>
		<m:mfrac>
			<m:mn>1</m:mn>
			<m:mrow><m:mi>k</m:mi><m:mo>!</m:mo></m:mrow>
		</m:mfrac>
		<m:msup>
			<m:mi>x</m:mi>
			<m:mi>k</m:mi>
		</m:msup>
	</m:mrow>
</m:math>
					</div>
				</section>
			</section> <section>
				<hgroup>
					<h1>基本戦略 1</h1>
					<div class="subTitle">計算順序の工夫</div>
				</hgroup>
				<p>
計算には Taylor 展開が含まれるため、有限級数近似を行う。
				</p> <p>
ここで、計算順序を少し工夫するだけで計算量を改善できる。
				</p>
				<section>
					<h2>効率の悪い方法</h2>
					<p>
行列指数関数の Taylor 展開の計算後に、ベクトルとの積を行う。
					</p> <p>
計算量は密行列でも疎行列でも <m:math><m:mi>O</m:mi><m:mo stretchy="false">(</m:mo><m:msup><m:mi>n</m:mi><m:mn>3</m:mn></m:msup><m:mo stretchy="false">)</m:mo></m:math> になる。これは <m:math><m:mi>n</m:mi></m:math> 次正方行列どうしの行列積の計算量と等しい。つまり、Taylor 展開の各回の計算では、保存した前回の結果との行列積で計算できるが、この部分が計算量を支配している。
					</p> <p>
なお、疎行列でも密行列でも計算量が同じなのは、積のたびに次第に密化するためである。
					</p> <p>
ちなみに、行列指数関数の計算には Pade 近似など他の方法もある (詳細は割愛)。これらはより少ない級数で近似できるなど効率的ではあるが、影響は高々定数倍である。
					</p>
				</section> <section>
					<h2>効率の良い方法</h2>
					<p>
行列指数関数の Taylor 展開にベクトルとの積を混ぜる。
					</p> <p>
計算量は密行列で <m:math><m:mi>O</m:mi><m:mo stretchy="false">(</m:mo><m:msup><m:mi>n</m:mi><m:mn>2</m:mn></m:msup><m:mo stretchy="false">)</m:mo></m:math> で疎行列で <m:math><m:mi>O</m:mi><m:mo stretchy="false">(</m:mo><m:mi>nnz</m:mi><m:mo stretchy="false">(</m:mo><m:mi>𝐀</m:mi><m:mo stretchy="false">)</m:mo><m:mo stretchy="false">)</m:mo></m:math> になる。これは <m:math><m:mi>n</m:mi></m:math> 次正方行列どうしの行列積の計算量より小さい。つまり、Taylor 展開の各回の計算では、保存した前回の結果との積とで計算できるが、これは行列とベクトルの積となるので、行列積が不要になる。
					</p>
				</section>
			</section> <section>
				<hgroup>
					<h1>基本戦略 2</h1>
					<div class="subTitle">Krylov 部分空間での近似</div>
				</hgroup>
				<p>
部分空間を定義し、その中に対象を圧縮して計算する。
				</p>
				<section>
					<h2>有利な状況</h2>
					<p>
以下のどれかを満たす状況で有利になる。
					</p>
					<ul>
						<li>
様々な <m:math><m:mi>t</m:mi></m:math> で計算
						</li> <li>
行列 <m:math><m:mi>𝐀</m:mi></m:math> が疎行列
						</li>
					</ul>
				</section> <section>
					<h2>有限級数近似</h2>
					<p>
対象の <m:math><m:mi>m</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:math> 次の有限級数近似を求める。
					</p>
					<div class="math">
<m:math display="block">
	<m:msup>
		<m:mi>e</m:mi>
		<m:mrow><m:mi>𝐀</m:mi><m:mi>t</m:mi></m:mrow>
	</m:msup>
	<m:mi>𝒃</m:mi>
	<m:mo>≈</m:mo>
	<m:mrow>
		<m:munderover>
			<m:mo>∑</m:mo>
			<m:mrow><m:mi>k</m:mi><m:mo>=</m:mo><m:mi>0</m:mi></m:mrow>
			<m:mrow><m:mi>m</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow>
		</m:munderover>
		<m:mfrac>
			<m:mn>1</m:mn>
			<m:mrow><m:mi>k</m:mi><m:mo>!</m:mo></m:mrow>
		</m:mfrac>
		<m:msup>
			<m:mi>t</m:mi>
			<m:mi>k</m:mi>
		</m:msup>
		<m:msup>
			<m:mi>𝐀</m:mi>
			<m:mi>k</m:mi>
		</m:msup>
		<m:mi>𝒃</m:mi>
	</m:mrow>
</m:math>
					</div>
					<p>
ただし、<m:math><m:mi>m</m:mi><m:mo>≪</m:mo><m:mi>n</m:mi></m:math> とする。
					</p>
				</section> <section>
					<h2>Krylov 部分空間</h2>
					<p>
上記の近似式は <m:math><m:mi>m</m:mi></m:math> 個のベクトル <m:math><m:msup><m:mi>𝐀</m:mi><m:mi>k</m:mi></m:msup><m:mi>𝒃</m:mi></m:math> の線形結合である。
					</p> <p>
これらのベクトルにより張られる部分空間を Krylov 部分空間という。
					</p>
					<div class="math">
<m:math display="block">
	<m:msub>
		<m:mi>𝒦</m:mi>
		<m:mi>m</m:mi>
	</m:msub>
	<m:mo>=</m:mo>
	<m:mrow>
		<m:mi>span</m:mi>
		<m:mo>{</m:mo>
		<m:mi>𝒃</m:mi>
		<m:mo>,</m:mo>
		<m:mi>𝐀</m:mi><m:mi>𝒃</m:mi>
		<m:mo>,</m:mo>
		<m:msup><m:mi>𝐀</m:mi><m:mi>2</m:mi></m:msup><m:mi>𝒃</m:mi>
		<m:mo>,</m:mo>
		<m:mi>⋯</m:mi>
		<m:mo>,</m:mo>
		<m:msup><m:mi>𝐀</m:mi><m:mrow><m:mi>m</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msup><m:mi>𝒃</m:mi>
		<m:mo>}</m:mo>
	</m:mrow>
</m:math>
					</div>
				</section> <section>
					<h2>部分空間での計算</h2>
					<p>
以下の要素が必要となるので <a href="#arnordiMethod">Arnordi 法</a>により求める。
					</p>
					<ul>
						<li>
<m:math><m:msub><m:mi>𝐕</m:mi><m:mi>m</m:mi></m:msub></m:math>: Krylov 部分空間の正規直交基底 (<m:math><m:mi>n</m:mi><m:mo>×</m:mo><m:mi>m</m:mi></m:math> 行列)
						</li> <li>
<m:math><m:msub><m:mi>𝐇</m:mi><m:mi>m</m:mi></m:msub></m:math>: <m:math><m:mi>𝐀</m:mi></m:math> を <m:math><m:msub><m:mi>𝐕</m:mi><m:mi>m</m:mi></m:msub></m:math> へと圧縮した行列 (<m:math><m:mi>m</m:mi><m:mo>×</m:mo><m:mi>m</m:mi></m:math> 行列)
						</li>
					</ul>
					<p class="todo">注: 書きかけです。</p>
				</section>
			</section>
		</section> <section>
			<h1 id="arnordiMethod">Arnordi 法</h1>
			<p class="todo">注: 書きかけです。</p>
		</section>
	</body>
</html>
